/**
 * videojs-hls-quality-selector
 * @version 0.0.1
 * @copyright 2017 Chris Boustead (chris@forgemotion.com)
 * @license MIT
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],e):t.videojsHlsQualitySelector=e(t.videojs)}(this,function(t){"use strict";t=t&&t.hasOwnProperty("default")?t.default:t;!function(){function t(t){this.value=t}function e(e){function n(i,l){try{var u=e[i](l),r=u.value;r instanceof t?Promise.resolve(r.value).then(function(t){n("next",t)},function(t){n("throw",t)}):o(u.done?"return":"normal",u.value)}catch(t){o("throw",t)}}function o(t,e){switch(t){case"return":i.resolve({value:e,done:!0});break;case"throw":i.reject(e);break;default:i.resolve({value:e,done:!1})}(i=i.next)?n(i.key,i.arg):l=null}var i,l;this._invoke=function(t,e){return new Promise(function(o,u){var r={key:t,arg:e,resolve:o,reject:u,next:null};l?l=l.next=r:(i=l=r,n(t,e))})},"function"!=typeof e.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(e.prototype[Symbol.asyncIterator]=function(){return this}),e.prototype.next=function(t){return this._invoke("next",t)},e.prototype.throw=function(t){return this._invoke("throw",t)},e.prototype.return=function(t){return this._invoke("return",t)}}();var e=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},n={},o=t.registerPlugin||t.plugin,i=function(e){var o=this;this.ready(function(){!function(t,e){t.addClass("vjs-hls-quality-selector"),t.hlsQualitySelector=new l(t,e)}(o,t.mergeOptions(n,e))})},l=function(){function n(t,o){e(this,n),this.player=t,this.player.qualityLevels&&this.getHls()&&(this.createQualityButton(),this.bindPlayerEvents())}return n.prototype.getHls=function(){return this.player.tech({IWillNotUseThisInPlugins:!0}).hls},n.prototype.bindPlayerEvents=function(){this.player.qualityLevels().on("addqualitylevel",this.onAddQualityLevel.bind(this))},n.prototype.createQualityButton=function(){var e=this.player,n=t.getComponent("MenuButton"),o=t.extend(n,{constructor:function(){n.call(this,e,{title:"Quality"})},createItems:function(){return[]}});this._qualityButton=new o;var i=e.controlBar.children().length-2,l=e.controlBar.addChild(this._qualityButton,{componentClass:"qualitySelector"},i);l.addClass("vjs-quality-selector"),l.addClass("vjs-icon-hd"),l.removeClass("vjs-hidden")},n.prototype.getQualityMenuItem=function(e){var n=this,o=this.player,i=t.getComponent("MenuItem");return new(t.extend(i,{constructor:function(){i.call(this,o,{label:e.label,selectable:!0,selected:e.selected||!1})},handleClick:function(t){for(var o=0;o<n._qualityButton.items.length;++o)n._qualityButton.items[o].selected(!1);n.setQuality(e.value),this.selected(!0)}}))},n.prototype.onAddQualityLevel=function(t){for(var e=this.player.qualityLevels().levels_||[],n=[],o=0;o<e.length;++o){var i=this.getQualityMenuItem.call(this,{label:e[o].height+"p",value:e[o].height});n.push(i)}n.push(this.getQualityMenuItem.call(this,{label:"Auto",value:"auto",selected:!0})),this._qualityButton&&(this._qualityButton.createItems=function(){return n},this._qualityButton.update())},n.prototype.setQuality=function(t){for(var e=this.player.qualityLevels(),n=0;n<e.length;++n){var o=e[n];o.enabled=o.height===t||"auto"===t}this._qualityButton.unpressButton()},n}();return o("hlsQualitySelector",i),i.VERSION="0.0.1",i});